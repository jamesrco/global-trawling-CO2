# global-trawling-CO2
Code and data for refinement of the benthic trawling CO<sub>2</sub> emissions estimate originally presented in [Sala et al., 2021. Protecting the global ocean for biodiversity, food and climate. *Nature* **592**, 397–402](https://doi.org/10.1038/s41586-021-03371-z). We intend to present the reanalysis contained in this repository as a Matters Arising comment to the same journal. Calculations and data pertaining to other animal-mediated ocean carbon fluxes, including an analysis of the possible climate impacts from new benthic trawling in the emerging Arctic and support for a review (in prep) of zoogeochemical carbon fluxes in the ocean, are in [this repository](https://github.com/jamesrco/zoonotic-C).

### Raw, unmodified data and files

* The files in [data/global_trawling/raw/sala_et_al_2021](data/global_trawling/raw/sala_et_al_2021) are from [Sala et al., 2021. Protecting the global ocean for biodiversity, food and climate. *Nature* **592**, 397–402](https://doi.org/10.1038/s41586-021-03371-z). Data files were retrieved from https://doi.org/10.25349/D9N89M on June 6, 2022. Resolution of the CO2 flux dataset (in [co2_efflux.tif]((data/global_trawling/raw/sala_et_al_2021/co2_efflux.tif)) is 1 km<sup>2</sup>. Resolution of both of the other two trawling-related datasets ([bottom_trawling_Ia.tif](data/global_trawling/raw/sala_et_al_2021/bottom_trawling_Ia.tif) and [carbon_ranking.tif](data/global_trawling/raw/sala_et_al_2021/carbon_ranking.tif) is 50 km<sup>2</sup>.)

* The files in [data/global_trawling/raw/FMI_world_EEZ_boundaries_v11](data/global_trawling/raw/FMI_world_EEZ_boundaries_v11) represent version 11 of the Flanders Marine Institute's global exclusive economic zone (EEZ) dataset. Data files were retrieved from https://www.vliz.be/en/imis?dasid=6316&doiid=386 on August 4, 2022.

* The GeoTIFF in [data/global_trawling/raw/SRTM30_PLUS_v8](data/global_trawling/raw/SRTM30_PLUS_v8) is version 8 of the SRTM30 digital elevation model, a 1-km resolution global DEM that includes ocean bathymetry. Retrieved from https://nextcloud.eatlas.org.au/apps/sharealias/a/world_e-atlas-ucsd_srtm30-plus_v8-tif on August 5, 2022. The SRTM30 DEM is described here: https://eatlas.org.au/data/uuid/80301676-97fb-4bdf-b06c-e961e5c0cb0b 

* The dataset (.mat format) in [data/global_trawling/raw/UCSD_Argo_MLD_climatology](data/global_trawling/raw/UCSD_Argo_MLD_climatology) is the April 2022 version of the UCSD monthly mixed layer depth climatology, derived from Argo float profiles. Retrieved from http://mixedlayer.ucsd.edu/data/Argo_mixedlayers_monthlyclim_04142022.mat on August 19, 2022. The dataset is described here: http://mixedlayer.ucsd.edu

* The files "fseq_OCIM2_48L.mat" and "fseq_OCIM2_48L.nc" in [data/global_trawling/raw/siegel_et_al_2021_v2](data/global_trawling/raw/siegel_et_al_2021_v2) are from [Siegel et al., 2021. Assessing the sequestration time scales of some ocean-based carbon dioxide reduction strategies. *Environ. Res. Lett.* **16** 104003](https://iopscience.iop.org/article/10.1088/1748-9326/ac0be0#erlac0be0s5). The files contain the same data in MATLAB and NetCDF formats and were retrieved from https://doi.org/10.6084/m9.figshare.15228690.v2 on June 6, 2022. Per the published paper, model resolution is 2 degrees with 48 vertical levels. **Update: These files are not stored on GitHub due to size. User replicating this analysis will have to download the datasets from the figshare link and then move the files to the correct location.**

* The file "plot_sequestration_fraction.m" in [data/global_trawling/raw/siegel_et_al_2021_v2](data/global_trawling/raw/siegel_et_al_2021_v2) is the original, unmodified MATLAB script that Siegel et al. provided along with the data files containing the sequestration fractions. A modified version of this file, [global_trawling/gen_fracs_to_constrain_trawlCO2.m](global_trawling/gen_fracs_to_constrain_trawlCO2.m), was used to pull out the [necessary benthic sequestration fractions](data/global_trawling/derived/benthic_seqfractions) for the analysis using the [three R scripts in global_trawling](global_trawling/).

### Scripts

#### Shell scripts for AWS provisioning

* The shell scripts [still live here](https://github.com/jamesrco/zoonotic-C/tree/main/aws_provisioning). 

#### Global benthic trawling reanalysis

* The R and MATLAB scripts  [global_trawling/01_ConstrainCO2Flux_genSiegelMetaData.m](global_trawling/01_ConstrainCO2Flux_genSiegelMetaData.m), [global_trawling/02_ConstrainCO2Flux_IO.R](global_trawling/02_ConstrainCO2Flux_IO.R), [global_trawling/03_ConstrainCO2Flux_coordMatch.R](global_trawling/03_ConstrainCO2Flux_coordMatch.R), [global_trawling/04_ConstrainCO2Flux_genTrawlSeqFracs.m](global_trawling/04_ConstrainCO2Flux_genTrawlSeqFracs.m), [global_trawling/05_ConstrainCO2Flux_adjFlux_extended.R](global_trawling/05_ConstrainCO2Flux_adjFlux_extended.R), 
[global_trawling/06_ConstrainCO2Flux_adjFlux_MLDvalidation.R](global_trawling/06_ConstrainCO2Flux_adjFlux_MLDvalidation.R), 
[global_trawling/07_ConstrainCO2Flux_adjFlux_EEZs.R](global_trawling/07_ConstrainCO2Flux_adjFlux_EEZs.R), and [global_trawling/08_ConstrainCO2Flux_plots_and_tables.R](global_trawling/08_ConstrainCO2Flux_plots_and_tables.R) are the workhorse scripts for the benthic trawling reanalysis. They should be run in order, with the note that some of the `library()` calls and setting of working directory are repetitive. The R scripts assume that the objects generated in the previous scripts are still in the R environment.

### Outputs and derived data

* The files in [data/global_trawling/derived/benthic_seqfractions](data/global_trawling/derived/benthic_seqfractions) contain the applicable sequestration fractions for the indicated year(s) plus necessary metadata, pulled from the [original Siegel et al. model output](data/global_trawling/raw/siegel_et_al_2021_v2) using the scripts [global_trawling/01_ConstrainCO2Flux_genSiegelMetaData.m](global_trawling/01_ConstrainCO2Flux_genSiegelMetaData.m) and [global_trawling/04_ConstrainCO2Flux_genTrawlSeqFracs.m](global_trawling/04_ConstrainCO2Flux_genTrawlSeqFracs.m). [fseq_bottom.multyears.RData](data/global_trawling/derived/benthic_seqfractions/fseq_bottom.multyears.RData) is an R data object containing the necessary fractions for years 1-200 in one-year increments, plus years 300-1000 in 100-year increments. This object was assembled from the series of seven .mat files beginning with [fseq_bottom_multyears_1of7.mat](data/global_trawling/derived/benthic_seqfractions/fseq_bottom_multyears_1of7.mat), which were created and exported using [global_trawling/04_ConstrainCO2Flux_genTrawlSeqFracs.m](global_trawling/04_ConstrainCO2Flux_genTrawlSeqFracs.m). [trawlYears.csv](data/global_trawling/derived/benthic_seqfractions/trawlYears.csv) is a list of the years represented in this 3-D array, corresponding to the 3rd dimension of the array. The other files contain self-explanatory metadata/model domain parameters for the Siegel et al. OCIM48 model. 

* The files in [data/global_trawling/derived/output](data/global_trawling/derived/output) represent the outputs. Specifically:

    + [coord.matches.NonZero.RData](data/global_trawling/derived/output/coord.matches.NonZero.RData) is an R data object containing the indices (and corresponding coordinates) of the geographically closest data points in the Siegel et al. OCIM model output to the locations of the data points in the Sala et al. dataset which represent non-zero values of CO<sub>2</sub> flux. These matches were generated using [03_ConstrainCO2Flux_coordMatch.R](global_trawling/03_ConstrainCO2Flux_coordMatch.R).
    
    + [Sala_et_al_trawlTiming_results.csv](data/global_trawling/derived/sala_et_al_2021_model/Sala_et_al_trawlTiming_results.csv) contains the "timing" output from the sediment disturbance model presented in the Sala et al. paper (remineralization of 1.47 Pg CO<sub>2</sub> in the "first" year after commencement of trawling, declining to a steady rate of 0.58 Pg CO<sub>2</sub> yr<sup>-1</sup> at year 10 and beyond); this .csv file captures the values in the object `results` that is produced beginning on line 119 in [this script](https://github.com/emlab-ucsb/ocean-conservation-priorities/blob/master/ancillary_analyses/timing_of_trawling_impacts.Rmd).
    
    + [adjCO2efflux_global_PgCO2_yr.csv](data/global_trawling/derived/output/adjCO2efflux_global_PgCO2_yr.csv) contains adjusted global estimates of CO<sub>2</sub> emissions to the atmosphere in a given year *n* following a one-time, 1.47 Pg remineralization of CO<sub>2</sub> from sediment to bottom water in year 0 (as assumed by Sala et al.). The file includes adjusted (using the Siegel et al. sequestration fractions) estimates for several bottom depth fractions, and well as some unadjusted estimates for the same depth fractions. [adjCO2efflux_global_PgCO2_yr_byEEZ.csv](data/global_trawling/derived/output/adjCO2efflux_global_PgCO2_yr_byEEZ.csv) contains year-by-year estimates broken down by exclusive economic zone (EEZ) of the countries responsible for most of the world's benthic trawling.
    
    + [adjCO2efflux_global_PgCO2_cumulative.csv](data/global_trawling/derived/output/adjCO2efflux_global_PgCO2_cumulative.csv) contains cumulative global emissions estimates of CO<sub>2</sub> to the atmosphere based on the pattern of trawling-related sediment disturbance posited by Sala et al. (remineralization of 1.47 Pg CO<sub>2</sub> in the "first" year after commencement of trawling, declining to a steady rate of 0.58 Pg CO<sub>2</sub> yr<sup>-1</sup> at year 10 and beyond).  The file includes adjusted (using the Siegel et al. sequestration fractions) estimates for several bottom depth fractions, and well as some unadjusted estimates for the same depth fractions. [adjCO2efflux_global_PgCO2_cumulative_byEEZ.csv](data/global_trawling/derived/output/adjCO2efflux_global_PgCO2_cumulative_byEEZ.csv) contains cumulative emissions estimates (both adjusted and unadjusted) broken down by exclusive economic zone (EEZ) of the countries responsible for most of the world's benthic trawling.
    
    + The other files in this directory are useful data objects exported (and in few cases, then reimported) during the analysis. These include additional coordinate pairings ([matches against the UCSD MLD climatology dataset](data/global_trawling/derived/output/MLDmatches.nonZero.RData) for the MLD validation "gut check," and [coordinates subdivided by EEZ](data/global_trawling/derived/output/EEZ.nonZeroCO2points.RData)) and a [.csv file containing data and metadata, including bottom depths](data/global_trawling/derived/output/Sala_CO2_efflux_nonZero.csv) that had to be reimported into MATLAB for use in [global_trawling/04_ConstrainCO2Flux_genTrawlSeqFracs.m](global_trawling/04_ConstrainCO2Flux_genTrawlSeqFracs.m).